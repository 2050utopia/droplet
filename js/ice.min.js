/*~ <%= pkg.name %=> <%= grunt.template.today("yyyy-mm-dd") %=> */
(function(){var Block,Socket,State,defaultState,defaultStateElement;State=function(){function State(elements){var element,_i,_len;for(this.stack={next:null,element:null},_i=0,_len=elements.length;_len>_i;_i++)element=elements[_i],this.push(element)}return State.prototype.pop=function(){return this.stack=this.stack.next},State.prototype.push=function(element){var new_stack;return new_stack={next:this.stack,element:element},this.stack=new_stack},State.prototype.first=function(){return this.stack.element},State}(),defaultStateElement=function(){return{multiline:!1}},defaultState=function(){return new State([defaultStateElement()])},Block=function(){function Block(prev,next){this.prev=prev,this.next=next,this.paper=null,this.multiline=!1}return Block.prototype.moveTo=function(socket){return this.prev.empty(),this.prev=null,socket.empty(),this.prev=socket,this.next=socket.next,socket.insert(this),this.next.recompute(new State([{multiline:this.multiline}]))},Block.prototype.recompute=function(state){return state.push(defaultStateElement()),this.next.recompute(state)},Block.prototype._endRecompute=function(state,next){return this.multiline=state.first.multiline,state.pop(),"connection"!==next.type&&(state.first.multiline=this.multiline),next.recompute(state)},Block.prototype.stringify=function(){return this.next.stringify},Block}(),Socket=function(){function Socket(prev,next){this.prev=prev,this.next=next,this.paper=null,this.multiline=!1,this.type=null}return Socket.prototype.empty=function(){return this.next=this.next.next},Socket.prototype.insert=function(next){return this.next=next},Socket.prototype.recompute=function(state){return"end"===type?this.block._endRecompute(state,this.next):this.next.recompute(state)},Socket.prototype.stringify=function(){var string;return string="string"==typeof value||value instanceof String?value:""},Socket}()}).call(this);